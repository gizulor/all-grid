<!DOCTYPE html>
<html lang="<txp:lang />" dir="<txp:text item="lang_dir" />">
<txp:output_form form="head" bodyclass="">
  <style>
    .article-ids a {
      color: var(--white);
      background: var(--black);
      aspect-ratio: 1/1;
      border-radius: 50%;
      width: 1rem;
      display: grid;
      justify-content: center;
      align-items: center;
      font-size: .65rem;
    }
  </style>
</txp:output_form>

<txp::o_header_common />

<main id="main" aria-label="<txp:text item="main_content" />" itemscope itemtype="https://schema.org/CreativeWork">

  <header class="l_width-limited--large u_p">
    <h1 class="h0-style">Images, Categorised, usage by articles</h1>
  </header>

<txp:images limit="1000" wraptag="ul" break="" class="l_grid l_grid--auto l_gap a_list-bare u_p u_m--tvh" sort="category asc">
  <txp:if_different>
      <li class="u_span--full-width"><h2 class="h3-style"><txp:evaluate>Image category: <txp:image_info type="category_title"  /><txp:else />(no category)</txp:evaluate></h2></li>
  </txp:if_different>

  <li class="l_grid--parent-rules u_span--2rows">

    <txp:hide>responsive thumbs</txp:hide>
    <txp::figure id='<txp:image_info type="id" />' class="a_image--contain" captionclass="b_small" />

    <txp:hide>
      txp thumbs
      <figure itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject">
          <txp:thumbnail />
          <txp::u_edit image />
          <txp:evaluate>
            <figcaption itemprop="caption" class="b_typeset b_small">
              <txp:image_info escape="textile" />
            </figcaption>
          </txp:evaluate>
      </figure>
    </txp:hide>

    <div class="l_beam l_beam--wrap l_gap--small">
      <span class="b_small"><a href="<txp:image_url />">#<txp:image_info type="id" /></a></span>
      <txp:variable name="article-ids" escape="trim">
        <txp:php>
          $id = (int) parse('
          <txp:image_info type="id" />');
          echo implode(', ', safe_column('ID', 'textpattern', "FIND_IN_SET({$id}, Image)"));
        </txp:php>
      </txp:variable>
      <span class="article-ids l_beam b_small">
        <txp:if_variable name="article-ids" value>
        appears in article
          <txp:article_custom id='<txp:variable name="article-ids" />'>
            <txp:permlink title='<txp:title />'><txp:article_id /></txp:permlink>
          </txp:article_custom>
        <txp:else />
          <a>-</a>
        </txp:if_variable>
      </span>
    </div>

  </li>

</txp:images>
      <nav class="o_paginator <txp:yield name="class" />" aria-label="page nav">

    <txp:newer rel="prev"><span class="a_icon a_icon--large a_icon--arrowcirc-left">&#10132;</span> Previous</txp:newer>
    <txp:older rel="next">Next <span class="a_icon a_icon--large a_icon--arrowcirc">&#10132;</span></txp:older>
  </nav>
</main>

<txp::o_footer class="u_p l_width-limited--large" />
<txp::o_javascript />
</body>

</html>